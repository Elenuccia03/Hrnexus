<link rel="stylesheet" href="~/css/calendariolavoratori.css">
 <div class="search-container">
    <input type="text" id="search" placeholder="Cerca dipendente...">
    <button id="search-button">Cerca</button>
</div>

<div class="calendar-container">
    <div class="month-selector">
        <button id="prev-month">&lt;</button>
        <span id="current-month"></span>
        <button id="next-month">&gt;</button>
    </div>
    <div class="calendar" id="calendar"></div>
</div>

<div class="modal" id="modal">
    <div class="modal-content">
        <span class="close" id="close">&times;</span>
        <h2 id="modal-date"></h2>
        <textarea id="appointment" rows="4" cols="50"></textarea>
        <button id="save">Salva</button>
    </div>
</div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const calendar = document.getElementById('calendar');
            const modal = document.getElementById('modal');
            const close = document.getElementById('close');
            const saveButton = document.getElementById('save');
            const modalDate = document.getElementById('modal-date');
            const appointment = document.getElementById('appointment');
            const prevMonth = document.getElementById('prev-month');
            const nextMonth = document.getElementById('next-month');
            const currentMonth = document.getElementById('current-month');
            let selectedDate;
            let currentYear = new Date().getFullYear();
            let currentMonthIndex = new Date().getMonth();

            function updateCalendar() {
                calendar.innerHTML = '';
                const daysInMonth = new Date(currentYear, currentMonthIndex + 1, 0).getDate();
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayElement = document.createElement('div');
                    dayElement.textContent = day;
                    dayElement.classList.add('day');
                    dayElement.addEventListener('click', function() {
                        selectedDate = `${day}/${currentMonthIndex + 1}/${currentYear}`;
                        modalDate.textContent = `Impegno del giorno ${selectedDate}`;
                        appointment.value = localStorage.getItem(`appointment-${selectedDate}`) || '';
                        modal.style.display = 'flex';
                    });
                    calendar.appendChild(dayElement);
                }
                currentMonth.textContent = new Date(currentYear, currentMonthIndex).toLocaleString('default', { month: 'long', year: 'numeric' });
            }

            close.addEventListener('click', function() {
                modal.style.display = 'none';
            });

            window.addEventListener('click', function(event) {
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            });

            saveButton.addEventListener('click', function() {
                localStorage.setItem(`appointment-${selectedDate}`, appointment.value);
                alert('Impegno salvato!');
                modal.style.display = 'none';
            });

            prevMonth.addEventListener('click', function() {
                currentMonthIndex--;
                if (currentMonthIndex < 0) {
                    currentMonthIndex = 11;
                    currentYear--;
                }
                updateCalendar();
            });

            nextMonth.addEventListener('click', function() {
                currentMonthIndex++;
                if (currentMonthIndex > 11) {
                    currentMonthIndex = 0;
                    currentYear++;
                }
                updateCalendar();
            });

            updateCalendar();
        });
    </script>